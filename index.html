
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<!-- saved from url=(0021)http://xentao.com/mp/ -->
<html style="" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">

        <title>wxw.io</title>

        <style type="text/css">
         * { font-family: monospace; }
        </style>

        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
        <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
    </head>
    <body>
        <script src="cryptojs/rollups/pbkdf2.js"></script>
        <script src="cryptojs/rollups/aes.js"></script>
        <script src="cryptojs/components/enc-base64-min.js"></script>
        <script src="cryptojs/components/core-min.js"></script>
        <script src="cryptojs/rollups/sha256.js"></script>
        <script src="cryptojs/components/enc-utf16-min.js"></script>

        <script>

            $(document).ready( function() {
                var hash = window.location.hash.substring(1);
                if( hash )
                    $('#ciphertext').val(hash);

                $( '#buttonEncrypt' ).click( function(event)  {
                    $('#ciphertext').val('');
                    var ciphertext = encrypt( getPlaintext() );
                    ciphertext = CryptoJS.enc.Base64.stringify(ciphertext.ciphertext);
                    $('#ciphertext').val(ciphertext);
                });

                $( '#buttonDecrypt' ).click( function(event)  {
                    $('#plaintext').val('');
                    var ciphertext = getCiphertext();
                    ciphertext = CryptoJS.enc.Base64.parse(ciphertext);
                    var plaintext = decrypt( ciphertext );
                    $('#plaintext').val(plaintext);
                });


            });

            function 
            getPlaintext() {
                return $('#plaintext').val();
            }

            function 
            getCiphertext() {
                return $('#ciphertext').val();
            }

            function 
            getPassword() {
                return $('#password').val();
            }

            function 
            getKey() {
                var key = CryptoJS.PBKDF2( getPassword(), getSalt(), { keySize: 512/32 } );
                return key;
            }

            function 
            getIV() {
                return CryptoJS.enc.Hex.parse('cd7bf0d4d1f1729b62de3d0147b13eb0');
            }

            function 
            getSalt() {
                return CryptoJS.enc.Hex.parse('0e6b1abcf209a36cc6796d48afcc329e');
            }

            function 
            encrypt(plaintext) {
                var ciphertext = CryptoJS.AES.encrypt( plaintext, getKey(), { iv: getIV() } );
                return ciphertext;
            }

            function 
            decrypt(ciphertext) {
                var plaintext = CryptoJS.AES.decrypt( ciphertext, getKey(), { iv: getIV() } );
                return plaintext;
            }

        </script>

        <div>
            <section>
                <label for="password">Password</label>
                <input id="password" name="password" type="text">


                <label for="plaintext">Plaintext</label>
                <input id="plaintext" name="plaintext" type="text">

                <label for="ciphertext">Ciphertext</lable>
                <input id="ciphertext" name="ciphertext" type="text">

                <button id="buttonEncrypt"  >Encrypt</button>
                <button id="buttonDecrypt"  >Decrypt</button>
            </section>
        </div>

       </body>

</html>